<style>
    body, table, td, th, div, h1, h2, h3, h4, h5, h6, caption, strong {
        font-family: 'TH Sarabun', sans-serif;
        font-size: 8pt;
    }
    table.table-bordered {
        border-collapse: collapse;
        width: 100%;
        margin-top: 10px;
    }
    table.table-bordered th, table.table-bordered td {
        border: 1px solid #000;
        padding: 5px;
    }
    th[style*="text-align:center"], td[style*="text-align:center"] {
        text-align: center;
    }
    td[style*="text-align:right"], th[style*="text-align:right"] {
        text-align: right;
    }
    caption {
        font-weight: bold;
        margin-bottom: 5px;
        text-align: left;
    }
</style>

{# ------------------- TOTAL line = Summary of Payment Entry Reference -------------------- #}
{% if doc.doctype == 'XXX' %}
<table class="table table-bordered table-condensed">
    <caption><strong>สรุปยอดจาก Payment Entry Reference</strong></caption>
    <tr>
        <th></th>
        <th style="text-align:center">ยอดค้างชำระ</th>
        <th style="text-align:center">ยอดจัดสรร</th>
    </tr>
    {% set outsumm = [0] %}
    {% set asumm = [0] %}
    {% for item in doc.references %}
        {% if asumm.append(asumm[-1] + item.allocated_amount) %}{% endif %}
        {% if outsumm.append(outsumm[-1] + item.outstanding_amount) %}{% endif %}
    {% endfor %}
    <tr>
        <td style="text-align:right"><strong>รวมทั้งหมด</strong></td>
        <td style="text-align:right"><strong>{{ frappe.utils.fmt_money(outsumm[-1], format='Thai') }}</strong></td>
        <td style="text-align:right"><strong>{{ frappe.utils.fmt_money(asumm[-1], format='Thai') }}</strong></td>
    </tr>
</table>
{% endif %}