<style>
    /* Reset และสไตล์พื้นฐาน */
    body, body *:not(style):not(script) {
        font-family: "TH Sarabun New", "TH Sarabun", sans-serif !important;
        font-size: 14pt !important;
        line-height: 1.5;
    }
    
    /* หัวเรื่องเอกสาร */
    .print-heading h2 {
        font-size: 16pt !important;
        text-align: right;
        margin-bottom: 5px;
    }
    
    .sub-heading {
        font-size: 13pt !important;
        text-align: right;
        display: block;
        margin-bottom: 15px;
    }
    
    /* ตารางและข้อมูล */
    .data-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .data-table td {
        padding: 3px 5px;
        vertical-align: top;
    }
    
    .data-label {
        font-weight: bold;
        white-space: nowrap;
    }
    
    .data-value {
        word-break: break-word;
    }
    
    /* สถานะเอกสาร */
    .draft-watermark {
        color: red;
        font-weight: bold;
        text-align: center;
        margin-bottom: 10px;
    }
    
    /* ระยะห่าง */
    .margin-bottom {
        margin-bottom: 15px;
    }
</style>

{% set hhh= doc.name[:2] %}
{% if doc.name[:2] == 'RV' %} {% set xhead  = 'สมุดรายวันรับชำระ' %} {% set xsubhead  = 'Cash Receipts Journal' %}
{% else %}  {% if doc.name[:2] == 'RO' %} {% set xhead  = 'สมุดรายวันรับเงินอื่นๆ'%} {% set xsubhead  = 'Receipt Other' %}
{% else %}  {% if doc.name[:2] == 'RP' %} {% set xhead  = 'สมุดรายวัน clear เงินทดรองจ่าย'%} {% set xsubhead  = 'Clear Advance Journal' %}
{% else %}  {% if doc.name[:7] == 'ITG-PEY' %} {% set xhead  = 'สมุดรายวันจ่ายพนักงาน'%} {% set xsubhead  = 'Employee' %}
{% else %}  {% if doc.name[:7] == 'ITG-PPP' %} {% set xhead  = 'ใบสำคัญตัดเงินจ่ายล่วงหน้า'%} {% set xsubhead  = 'P-Payment' %}
{% else %}  {% if doc.name[:6] == 'ITG-PI' %} {% set xhead  = 'สมุดรายวันตัดตั๋วรับ'%} {% set xsubhead  = 'Pay-in' %}
{% else %}  {% if doc.name[:6] == 'ITG-PO' %} {% set xhead  = 'สมุดรายวันตัดตั๋วจ่าย'%} {% set xsubhead  = 'Pay Out' %}
{% else %}  {% if doc.name[:2] == 'PV' %} {% set xhead  = 'สมุดรายวันจ่ายชำระ'%} {% set xsubhead  = 'Payment Journal' %}
{% else %}                                {% set xhead     = 'Payment Entry' %} {% set xsubhead  = doc.name %}
{% endif %} {% endif %} {% endif %} {% endif %} {% endif %} {% endif %} {% endif %} {% endif %}

<div class="print-heading">				
    <h2>{{ xhead }}</h2>
    <small class="sub-heading">{{ xsubhead }}</small>				
</div>

{%- if doc.docstatus == 0 -%}
<div class="draft-watermark">
    <h4> == DRAFT == </h4>
</div>
{%- endif -%}

{# --------------------------------------- #}
{% if doc.payment_type != 'Internal Transfer' %}
    {% set xparty  = doc.party_name %}
{% else %}
    {% if doc.refer_party_type in  ("Customer","Supplier", "Employee") %}  {% set xparty   = doc.refer_party_name %}
    {% else %}                           {% set xparty   = doc.refer_party_name %}
    {% endif %}
{% endif %}

<div class="row margin-bottom">
    <!-- คอลัมน์ซ้าย -->
    <div class="col-xs-6">
        <table class="data-table">
            {% if doc.name[:6] == 'ITG-PI' %}
                <tr>
                    <td class="data-label">Pay-In:</td>
                    <td class="data-value">{{ doc.paid_from_account_type }}</td>
                </tr>
            {% else %}
                <tr>
                    <td class="data-label"> Party:</td>
                    <td class="data-value">{{ xparty }}</td>
                </tr>
                {% if doc.name[:2] != 'RO' and doc.payment_type != 'Internal Transfer' %}
                    <tr>
                        <td class="data-label">Address:</td>
                        <td class="data-value">{{ doc.refer_full_address or '' }}</td>
                    </tr>
                    <tr>
                        <td class="data-label">TAX ID:</td>
                        <td class="data-value">{{ doc.refer_tax_number or '' }}</td>
                    </tr>
                {% endif %}
            {% endif %}
        </table>
    </div>
    
    <!-- คอลัมน์ขวา -->
    <div class="col-xs-6">
        <table class="data-table">
            <tr>
                <td class="data-label">Document No:</td>
                <td class="data-value">{{ doc.name }}</td>
            </tr>
            <tr>
                <td class="data-label">Date:</td>
                <td class="data-value">{{ frappe.utils.format_date(doc.posting_date, "dd-mm-yyyy") }}</td>
            </tr>
            <tr>
                <td class="data-label">Currency:</td>
                <td class="data-value">{{ doc.paid_to_account_currency }} (อัตราแลกเปลี่ยน: {{ doc.target_exchange_rate }})</td>
            </tr>
            <tr>
                <td class="data-label">NAV ref No::</td>
                <td class="data-value">{{ doc.nav_reference_no or '' }}</td>
            </tr>
        </table>
    </div>
</div>